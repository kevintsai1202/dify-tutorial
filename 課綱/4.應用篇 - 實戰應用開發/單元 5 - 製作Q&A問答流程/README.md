# 單元 5 - 製作 Q&A 問答流程

![封面](cover.png)

> 🕐 預估時長：25 分鐘

## 學習目標

完成本單元後，您將能夠：
- 整合「問題分類器」與「知識庫檢索」打造智慧客服
- 實作「引用歸屬 (Citation)」功能，讓回答有憑有據
- 設計「安撫情緒」的對話支線

## 內容大綱

### 1. 智慧客服架構圖

一個成熟的 AI 客服流程通常包含以下步驟：
1.  **意圖識別**：判斷使用者來意 (查資料? 抱怨? 閒聊?)。
2.  **分流處理**：
    -   **查資料** -> 走 RAG 流程 (檢索知識庫)。
    -   **抱怨** -> 走安撫流程 (不查資料，專注於情緒價值)。
    -   **其他** -> 拒絕回答或轉接人工。

### 2. 實作步驟

#### Step 1: 問題分類器 (Question Classifier)
設定三個分類：
1.  `Customer_Service` (關於產品、帳單、訊號等問題)
2.  `Complaint` (情緒發洩、罵人)
3.  `Others` (其他)

#### Step 2: 知識檢索 (Knowledge Retrieval)
將 `Customer_Service` 的線路連接到此節點。
-   **Query**：填入 User Input。
-   **Top K**：設定一次要抓幾筆資料 (建議 3~5 筆)。
-   **Score Threshold**：設定分數門檻 (建議 0.6 ~ 0.8)，避免抓到不相關的資料。

#### Step 3: LLM 回答
將檢索到的 `Context` (上下文) 餵給 LLM。
**System Prompt 範例**：
> "你是一個專業客服，請根據以下的【上下文】來回答使用者的問題。如果【上下文】中沒有答案，請誠實說不知道，不要捏造。"

#### Step 4: 引用歸屬 (Citation)
在「功能 (Features)」設定中，開啟 **「引用和歸屬」**。
這樣當 AI 回答問題時，會在答案下方標註 `[1]`、`[2]`，告訴使用者這段資訊是來自哪一份文件的哪一段落，大幅增加可信度。

### 3. 定製化回應 (針對抱怨)

對於 `Complaint` 分類，我們不需要查知識庫，直接連接到另一個 LLM 節點。
**System Prompt 範例**：
> "User 現在情緒很激動，請扮演一個富有同理心的客服主管，先安撫他的情緒，並承諾會盡快專人處理，不要講大道理。"

這樣我們就完成了一個既能解決問題，又懂人情世故的 AI 客服了！

---

## 📝 課後小測驗

> [!QUIZ]
> **Q: 在 AI 客服流程中，我們先進行「意圖識別 (分類)」的主要目的是什麼？**
> - [ ] 為了拖延時間
> - [x] 避免所有問題都去查知識庫，節省資源並提供更精準的回答策略
> - [ ] 為了收集使用者的個資

> [!QUIZ]
> **Q: 開啟「引用歸屬 (Citation)」功能有什麼好處？**
> - [x] 讓使用者知道答案的出處，增加可信度
> - [ ] 可以讓字數變多
> - [ ] 可以自動封鎖惡意使用者

> [!QUIZ]
> **Q: 當使用者的問題在知識庫中找不到答案時，最好的處理方式是？**
> - [ ] 讓 AI 自己編一個合理的答案
> - [x] 讓 AI 誠實回答「找不到相關資訊」或引導轉接人工
> - [ ] 罵使用者問題太難
