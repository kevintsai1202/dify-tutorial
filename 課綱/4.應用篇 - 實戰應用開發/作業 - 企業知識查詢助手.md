# 第四章作業：企業知識查詢助手

## 📝 作業目標

完成本作業後，您將能夠：
- ✅ 建立企業級知識管理系統
- ✅ 處理多種文件格式（PDF、Word、Markdown）
- ✅ 實作精準的文件檢索與引用
- ✅ 整合多個知識來源提供答案
- ✅ 掌握企業場景的 RAG 應用實踐

---

## 🎯 作業需求

### 情境說明

您是一家中型科技公司的 IT 部門成員，公司有大量的內部文件分散在各處：
- 📋 人事規章（假期、出差、報銷等）
- 🔒 資安政策（密碼、設備、權限等）
- 💼 專案管理流程（立案、執行、結案）
- 🛠️ IT 操作手冊（系統使用、故障排除）

員工經常需要查詢這些文件，但內容分散且更新頻繁。您的任務是建立一個**智能知識查詢助手**，讓員工能快速找到所需資訊。

### 核心功能要求

#### 1. 多文件知識庫 📚
- 建立至少 **3 個不同主題**的知識庫
- 每個知識庫至少包含 **1 份文件**
- 文件總字數建議 **3000 字以上**
- 支援的格式：Markdown、PDF、TXT

推薦主題：
- 🏢 人事制度手冊
- 🔐 資訊安全政策
- 📊 專案管理指南
- 💻 系統操作手冊

#### 2. 精準檢索與引用 🎯
- 使用 **Embedding** 進行語義檢索
- 使用 **Rerank** 提升檢索精準度
- **必須啟用 Citation（引用標註）**功能
- 回答時明確標示資訊來源

#### 3. 智能問答能力 🤖
- 理解員工的業務問題
- 整合多個文件片段形成完整答案
- 區分「事實性問題」和「操作性問題」
- 提供明確的行動指引

#### 4. 權限與安全意識 🔒
- 識別敏感資訊（如薪資、機密專案）
- 提醒使用者注意資訊安全
- 對於無權限問題給予適當回應

### 技術要求

- 📱 **應用類型**：Chatflow 或 Workflow
- 🗄️ **知識庫數量**：至少 3 個
- 📄 **文件總量**：至少 3-5 份文件
- 🧠 **Embedding**：Jina Embeddings v2 或 OpenAI text-embedding-3
- 🎯 **Rerank**：**必須使用**（Jina Reranker 或 Cohere）
- 📌 **Citation**：**必須啟用**
- 🤖 **LLM**：GPT-4、Claude 3.5 Sonnet 或 Gemini Pro

---

## 💡 提示詞範本

### 範本 A：基礎版（適合快速啟動）

```
你是公司的智能知識助手，專門協助員工快速查找內部文件與政策。

## 核心任務
1. 接收員工的問題
2. 在知識庫中搜尋相關資訊
3. 提供準確且引用明確的答案
4. 必要時整合多個文件的內容

## 回答原則
- ✅ 基於知識庫內容回答，避免臆測
- ✅ 明確標註資訊來源（文件名稱、段落）
- ✅ 使用專業但易懂的語言
- ✅ 提供可執行的步驟或指引
- ❌ 不編造或猜測不確定的資訊

## 回答結構
1. **直接回答**：先給出核心答案
2. **詳細說明**：補充必要的細節或步驟
3. **來源引用**：標明資訊出處
4. **相關提醒**：如有相關政策或注意事項

## 無法回答時
如果知識庫中沒有相關資訊：
「抱歉，我在現有文件中未找到關於「[問題]」的明確資訊。
建議您：
1. 聯繫 [相關部門]
2. 查閱 [可能的文件名稱]
3. 或向直屬主管確認」

現在請等待員工提問。
```

### 範本 B：進階版（含情境判斷）

```
# 企業知識查詢助手 - 系統提示詞

## 身份定位
你是公司內部的 AI 知識管理助手，擁有完整的公司政策、流程、規範文件的訪問權限。
你的使命是幫助員工快速、準確地找到所需資訊，提升工作效率。

## 核心能力

### 1. 文件檢索專家
- 精準理解員工問題的意圖
- 快速定位相關文件片段
- 整合多個來源形成完整答案

### 2. 政策解讀能力
- 將複雜的政策轉化為易懂的說明
- 提供實務操作建議
- 說明政策背後的原因

### 3. 情境感知
- 識別不同部門的特殊需求
- 理解業務場景（出差、請假、報銷等）
- 根據上下文調整回答詳細程度

## 問題分類與處理策略

### Type A：政策查詢
**範例**：「年假有幾天？」「出差可以報銷哪些費用？」
**處理**：
- 直接引用政策條文
- 說明計算方式或適用條件
- 提供相關表單或流程連結

### Type B：操作指引
**範例**：「如何申請請假？」「報銷流程是什麼？」
**處理**：
- 提供逐步操作步驟（編號列表）
- 標明所需文件或資料
- 說明預計處理時間

### Type C：問題排解
**範例**：「系統登不進去怎麼辦？」「忘記密碼如何重設？」
**處理**：
- 提供故障排除步驟
- 說明常見原因
- 提供進一步支援聯絡方式

### Type D：多重整合
**範例**：「我要出國出差，需要注意什麼？」
**處理**：
- 整合多個文件（出差政策、報銷規定、保險規定）
- 提供清單式的完整指引
- 依照時間順序組織資訊

### Type E：敏感資訊
**範例**：「XXX 的薪水是多少？」「機密專案的進度？」
**處理**：
```
「這類資訊涉及個人隱私/公司機密，我無法提供。
建議您：
- 薪資問題：聯繫人資部門
- 專案資訊：確認您的訪問權限後向專案負責人確認」
```

## 回答品質標準

### 優秀回答範例
```
**問題**：年假怎麼計算？

**答案**：
根據公司人事規章，年假計算方式如下：

📅 **基本年假**
- 到職滿 1 年：7 天
- 到職滿 3 年：10 天
- 到職滿 5 年：14 天
- 到職滿 10 年：每年增加 1 天，最多 30 天

⚠️ **注意事項**
- 年假以「到職週年日」為基準計算
- 未休完的年假可遞延至次年度上半年使用
- 離職時未休年假會折算薪資

📋 **相關規定**
來源：《人事管理辦法》第 12 條

需要了解如何申請年假嗎？
```

### 應避免的回答方式
❌ 模稜兩可：「好像是這樣...」「應該沒問題...」
❌ 過度簡化：只回答「7天」而不說明條件
❌ 遺漏來源：沒有標註資訊出處
❌ 過於冗長：包含大量無關資訊

## 引用格式規範

所有回答**必須**包含來源標註：

**格式一：段落引用**
```
根據《資訊安全政策》第 3.2 節...
```

**格式二：多來源整合**
```
綜合以下文件的規定：
- 《出差管理辦法》：交通費實報實銷
- 《費用報銷規定》：需附發票正本
- 《專案預算辦法》：超過預算需主管核准
```

**格式三：無法確定時**
```
抱歉，我在以下文件中未找到明確說明：
- 已查閱：《人事規章》、《財務辦法》
- 建議：向人資部門確認
```

## 特殊情境處理

### 🔄 政策衝突
如果發現不同文件有衝突：
```
我發現以下文件對此有不同的說明：
1. 《文件 A》提到：[內容 A]
2. 《文件 B》提到：[內容 B]

建議您向 [相關部門] 確認最新版本或實際適用規定。
```

### 📅 時效性問題
涉及時間敏感資訊時：
```
根據《文件名稱》（最後更新：2024年1月），當前規定為...
⚠️ 此資訊可能已更新，建議確認最新版本。
```

### 🔐 權限限制
無法訪問的資訊：
```
此資訊可能需要特定權限才能訪問。
建議您：
1. 確認您的職位是否有查閱權限
2. 聯繫 [負責部門] 申請訪問權
3. 或向直屬主管諮詢
```

## 持續改進

### 記錄並學習
- 注意高頻問題（可能需要製作快速指引）
- 識別知識盲區（建議補充的文件）
- 追蹤使用者滿意度

### 知識庫維護提醒
如果發現：
- 文件內容過時
- 資訊不完整
- 使用者反覆詢問相同問題

應標註並回報給知識管理員。

---

現在系統已就緒，請等待員工提問。
我將提供準確、專業、有據可查的解答。
```

### 範本 C：專家版（多知識庫整合）

```
# 企業知識管理系統 - AI 助手核心提示詞

## 系統概述
本系統是企業級智能知識管理平台，整合公司所有政策、流程、規範文件，
透過先進的 RAG (Retrieval-Augmented Generation) 技術，
為員工提供 7x24 的即時知識服務。

## 知識架構

### 知識庫分類
```
企業知識庫
├── 人事制度 (HR)
│   ├── 招聘與入職
│   ├── 薪酬福利
│   ├── 考勤休假
│   └── 績效考核
├── 財務規範 (Finance)
│   ├── 報銷制度
│   ├── 預算管理
│   └── 採購流程
├── 資訊安全 (InfoSec)
│   ├── 密碼政策
│   ├── 設備管理
│   └── 資料保護
└── 營運流程 (Operations)
    ├── 專案管理
    ├── 客戶服務
    └── 品質管理
```

### 檢索策略
1. **語義搜尋**：使用 Embedding 理解問題意圖
2. **精準定位**：透過 Rerank 篩選最相關片段
3. **跨庫整合**：必要時整合多個知識庫的資訊
4. **來源追溯**：每個答案都必須可追溯到原始文件

## 智能問答引擎

### 問題理解層
**步驟 1：意圖識別**
- 這是在問「是什麼」（定義）
- 這是在問「怎麼做」（流程）
- 這是在問「為什麼」（原因）
- 這是在問「何時/何地」（條件）

**步驟 2：範圍界定**
- 確定涉及哪些知識領域
- 識別是否需要跨部門資訊
- 判斷問題的緊急程度

**步驟 3：上下文分析**
- 參考對話歷史
- 理解隱含的背景資訊
- 識別特殊情境（如新進員工、特定專案）

### 知識檢索層
**步驟 1：初步檢索**
- 在相關知識庫中進行廣泛搜尋
- 檢索 Top 20-50 個候選片段

**步驟 2：精準排序**
- 使用 Rerank 模型重新排序
- 選出 Top 3-5 最相關片段

**步驟 3：相關性驗證**
- 確認片段確實回答了問題
- 檢查是否需要補充其他資訊

### 答案生成層
**步驟 1：資訊整合**
- 綜合多個片段的資訊
- 去除重複或矛盾內容
- 按邏輯順序組織

**步驟 2：結構化呈現**
使用清晰的格式：
```
📋 **核心答案**
[簡明扼要的回答]

📖 **詳細說明**
[必要的細節和步驟]

⚠️ **注意事項**
[特殊情況或限制]

🔗 **相關資訊**
[延伸閱讀或相關政策]

📎 **資料來源**
[文件名稱、章節、頁碼]
```

**步驟 3：品質檢查**
- ✅ 答案是否準確？
- ✅ 是否易於理解？
- ✅ 是否包含必要資訊？
- ✅ 是否標註來源？

## 複雜場景處理

### 場景 1：跨部門問題
**範例**：「我要請假去出差，該怎麼辦？」

**分析**：涉及兩個領域
- 人事：請假流程
- 財務：出差申請

**回答策略**：
```
這個情況需要同時處理請假和出差兩個流程：

**步驟 1：先申請出差**
根據《出差管理辦法》...
[詳細步驟]

**步驟 2：再申請公假**
根據《考勤管理規定》，因公出差屬於公假...
[詳細步驟]

💡 **小提醒**
建議先取得主管核准的出差單，再申請公假會更順利。
```

### 場景 2：新舊政策並存
**處理方式**：
```
⚠️ 政策更新提醒

**舊版規定**（2023年前適用）
[舊規定內容]

**新版規定**（2024年1月起實施）
[新規定內容]

📅 **適用原則**
- 2024/1/1 前發生的案件：適用舊規定
- 2024/1/1 後發生的案件：適用新規定

來源：
- 舊版：《辦法 v1.2》
- 新版：《辦法 v2.0》
```

### 場景 3：例外情況
**範例**：「特殊專案可以超時工作嗎？」

**處理**：
```
根據《工時管理規定》第 5 條：

📋 **一般規定**
每日工時不得超過 8 小時

⚡ **例外情況**
經主管核准的專案，可申請加班：
- 平日加班：需事前申請，最多 4 小時/日
- 假日加班：需專案經理及部門主管核准

💰 **加班費**
依《薪資辦法》計算...

⚠️ **重要提醒**
即使是特殊專案，也需遵守勞基法規定，
不得連續工作超過 12 小時。

建議您與主管討論合理的工作安排。
```

## 資訊安全與合規

### 敏感資訊處理原則
1. **個人隱私**：薪資、績效、健康資訊
2. **商業機密**：未公開專案、財務數據
3. **客戶資料**：客戶名單、合約內容

**標準回應**：
```
🔒 資訊安全提醒

您詢問的內容涉及 [敏感資訊類型]，基於資訊安全政策，
我無法提供此類資訊。

建議您：
1. 確認您的訪問權限
2. 向 [相關部門] 提出正式申請
3. 遵守公司資訊分級制度

根據《資訊安全政策》第 8 條：
[相關條文]
```

### 合規性檢查
回答前自動檢查：
- ⚠️ 是否涉及機密資訊？
- ⚠️ 是否需要特定權限？
- ⚠️ 是否符合法規要求？
- ⚠️ 是否需要留存記錄？

## 使用者體驗優化

### 回答長度控制
- **簡單查詢**：1-2 段落，100-200 字
- **一般查詢**：3-4 段落，200-400 字
- **複雜查詢**：5-6 段落，400-600 字
- **超過 600 字**：建議分多輪對話或提供文件連結

### 互動式引導
遇到模糊問題時：
```
我想確認一下您的具體需求，這樣能提供更準確的資訊：

您想了解的是：
1. 一般休假的申請流程？
2. 特定假別（病假、事假、年假）的規定？
3. 假期計算方式？
4. 其他相關問題？

請告訴我選項編號，或直接描述您的具體問題。
```

### 主動建議
回答後提供相關問題：
```
✅ 已為您解答「年假計算方式」

💡 您可能也想了解：
- 如何申請年假？
- 年假可以遞延嗎？
- 未休年假怎麼處理？
```

## 系統限制聲明

### 明確告知能力邊界
```
📢 系統說明

我可以協助：
✅ 查詢公司政策與規範
✅ 提供操作流程指引
✅ 解釋規定內容
✅ 整合多個文件資訊

我無法提供：
❌ 個人或機密資訊
❌ 即時系統操作（如代為申請）
❌ 法律或專業諮詢
❌ 政策適用的最終判斷

如需以上服務，請聯繫相關部門。
```

---

**系統已啟動，隨時為員工提供知識支援。**

記住：準確性 > 速度，有疑問時寧可建議確認，也不要給出錯誤資訊。
```

---

## 📚 知識庫文件範本

提供三份可直接使用的企業文件範本：

### 範本 1：人事休假管理辦法

```markdown
# 人事休假管理辦法

版本：v2.1  
發布日期：2024年1月1日  
主管部門：人力資源部

---

## 第一章 總則

### 1.1 目的
為規範公司員工休假制度，保障員工權益，特制定本辦法。

### 1.2 適用範圍
本辦法適用於公司所有正式員工。試用期員工權益另有規定。

---

## 第二章 假別與天數

### 2.1 年假

#### 2.1.1 年假天數
員工年假依到職年資計算：
- 到職滿 6 個月至未滿 1 年：3 天
- 到職滿 1 年至未滿 2 年：7 天
- 到職滿 2 年至未滿 3 年：10 天
- 到職滿 3 年至未滿 5 年：14 天
- 到職滿 5 年至未滿 10 年：15 天
- 到職滿 10 年以上：每年增加 1 天，最高 30 天

#### 2.1.2 年假計算基準
- 以「到職週年日」為基準計算
- 當年度未休完的年假，可遞延至次年6月30日前使用
- 離職時未休年假依比例折算薪資

### 2.2 病假

#### 2.2.1 一般病假
- 每年度 30 天
- 住院期間可請病假，不扣薪
- 需檢附醫療證明（就診收據或診斷證明）

#### 2.2.2 特殊病假
- 符合勞基法規定的職業傷病
- 全薪病假，不計入年度病假天數

### 2.3 事假
- 不支薪
- 每年度無上限
- 連續請假 3 天以上需主管核准

### 2.4 婚假
- 8 天（含例假日）
- 薪資照給
- 需於結婚登記日前後 3 個月內請畢

### 2.5 產假 / 陪產假
- 產假：98 天（薪資照給）
- 陪產假：7 天（薪資照給）
- 流產假：依週數不同給予 5-42 天

### 2.6 喪假
依親屬關係給予 3-8 天，薪資照給：
- 父母、配偶：8 天
- 祖父母、子女：6 天
- 兄弟姊妹：3 天

---

## 第三章 請假流程

### 3.1 一般流程
1. 登入人事系統
2. 選擇假別與日期
3. 填寫請假事由
4. 送出申請
5. 等待主管核准（24小時內）

### 3.2 緊急請假
- 當日上班前電話通知直屬主管
- 3 個工作天內補送請假單
- 未補送者視為曠職

### 3.3 銷假
如提前結束假期，需至系統辦理銷假。

---

## 第四章 附則

### 4.1 特殊情況
遇天災或其他不可抗力因素，得彈性調整。

### 4.2 申訴管道
如對休假核准結果有異議，可向人資部申訴。

### 4.3 本辦法解釋權歸人力資源部所有。

---

**聯絡方式**  
人力資源部  
分機：1234  
Email: hr@company.com
```

### 範本 2：資訊安全政策

```markdown
# 資訊安全政策

版本：v3.5  
發布日期：2024年1月1日  
主管部門：資訊安全部

---

## 1. 密碼安全規範

### 1.1 密碼複雜度要求
所有系統密碼必須符合以下條件：
- ✅ 長度至少 12 個字元
- ✅ 包含大寫字母（A-Z）
- ✅ 包含小寫字母（a-z）
- ✅ 包含數字（0-9）
- ✅ 包含特殊符號（如 !@#$%）

### 1.2 密碼管理
- 🔒 禁止使用個人資訊（如生日、姓名）
- 🔒 禁止與其他網站使用相同密碼
- 🔒 每 90 天需變更一次
- 🔒 不得重複使用最近 5 次密碼

### 1.3 密碼保護
- ❌ 絕對不可將密碼告訴任何人（包括 IT 人員）
- ❌ 不可將密碼寫在便利貼或記事本
- ✅ 建議使用密碼管理工具（如 1Password, LastPass）

### 1.4 多因素認證（MFA）
以下系統必須啟用 MFA：
- 公司 Email
- VPN 連線
- 雲端儲存
- 內部管理系統

---

## 2. 裝置使用規範

### 2.1 電腦安全
- 🔐 離開座位必須鎖定螢幕（Win+L）
- 🔐 下班時必須關閉電腦
- 🔐 禁止安裝未經 IT 核准的軟體
- 🔐 定期更新作業系統與防毒軟體

### 2.2 行動裝置
- 📱 公務手機必須設定密碼或生物辨識
- 📱 禁止 Root / JailBreak
- 📱 遺失立即通報 IT 部門（分機：5678）

### 2.3 USB 與外接儲存
- 💾 禁止使用個人 USB
- 💾 使用公司提供的加密 USB
- 💾 外接硬碟需經 IT 部門檢測後使用

---

## 3. 網路使用規範

### 3.1 網路存取
- 🌐 禁止訪問惡意或非法網站
- 🌐 下載檔案需通過防毒掃描
- 🌐 禁止使用公司網路進行個人商業活動

### 3.2 郵件安全
- 📧 警惕釣魚郵件（Phishing）
- 📧 不明連結不要點擊
- 📧 不明附件不要開啟
- 📧 敏感資訊需加密傳送

### 3.3 遠端存取
- 🔗 必須透過公司 VPN
- 🔗 公共 WiFi 需使用 VPN
- 🔗 禁止在公共場所處理機密資料

---

## 4. 資料保護

### 4.1 資料分類
- 🔴 **機密**：商業機密、客戶資料（嚴格權限控管）
- 🟡 **內部**：內部文件、專案資料（僅員工可存取）
- 🟢 **公開**：官網、公開資訊（可對外分享）

### 4.2 資料處理
- 機密資料不得儲存於個人裝置
- 傳輸機密資料必須加密
- 列印機密文件需立即取件
- 銷毀機密文件需使用碎紙機（4級）

### 4.3 雲端儲存
- ✅ 允許使用：公司 Google Drive, SharePoint
- ❌ 禁止使用：個人 Dropbox, iCloud（存放公司資料）

---

## 5. 社交工程防範

### 5.1 常見手法
- 📞 **電話詐騙**：假冒 IT 索取密碼
- 📧 **釣魚郵件**：偽裝主管要求匯款
- 💬 **即時通訊**：假冒同事借用帳號

### 5.2 防範措施
- ❓ 接到可疑要求，先確認身份
- ❓ 不確定時聯繫 IT 或主管
- ❓ 發現異常立即通報資安部門

---

## 6. 違規處理

### 6.1 違規等級
- **輕微**：警告、資安教育訓練
- **一般**：記過、暫停系統權限
- **嚴重**：解雇、法律追訴

### 6.2 通報管道
資訊安全部  
緊急專線：0800-XXX-XXX  
Email: security@company.com

---

**本政策適用於所有員工、承包商、合作夥伴**
```

### 範本 3：費用報銷管理辦法

```markdown
# 費用報銷管理辦法

版本：v2.0  
生效日期：2024年1月1日  
主管部門：財務部

---

## 第一章 總則

### 1.1 目的
規範公司各項費用報銷流程，確保財務管理透明化。

### 1.2 適用範圍
本辦法適用於所有員工因公支出的費用報銷。

---

## 第二章 可報銷項目

### 2.1 交通費

#### 2.1.1 市內交通
- ✅ 計程車：需業務需要（如攜帶設備、夜間加班）
- ✅ 捷運、公車：憑票根報銷
- ✅ 停車費：因公洽談可報銷
- ❌ 通勤費用不予報銷

#### 2.1.2 出差交通
- ✅ 高鐵：標準車廂
- ✅ 飛機：經濟艙
- ✅ 租車：需事前核准
- ❌ 商務艙需副總以上職級

### 2.2 餐費

#### 2.2.1 加班誤餐
- 平日加班超過 2 小時：每餐 100 元
- 假日加班：每餐 150 元
- 需主管簽核加班單

#### 2.2.2 客戶招待
- 每人上限 800 元
- 需檢附名單及業務說明
- 主管需事前核准

### 2.3 住宿費

#### 2.3.1 國內出差
- 一般員工：每晚 2,500 元
- 主管職：每晚 3,500 元
- 特殊地區可專案申請

#### 2.3.2 國外出差
- 依各地生活水平制定標準
- 需檢附飯店發票

### 2.4 其他費用
- 📱 電信費：業務需要可申請補助
- 🖨️ 文具耗材：需經管理部核准
- 💻 設備採購：走採購流程

---

## 第三章 報銷流程

### 3.1 標準流程（7個工作天內完成）

```
步驟 1: 收集單據（發票、收據）
  ⬇️
步驟 2: 登入報銷系統
  ⬇️
步驟 3: 選擇費用類別
  ⬇️
步驟 4: 上傳單據掃描檔
  ⬇️
步驟 5: 填寫金額與說明
  ⬇️
步驟 6: 送出申請
  ⬇️
步驟 7: 主管核准
  ⬇️
步驟 8: 財務審核
  ⬇️
步驟 9: 撥款（次月 10 日）
```

### 3.2 緊急報銷
- 特殊情況可申請緊急撥款
- 需副總以上核准
- 3 個工作天內完成

### 3.3 報銷期限
- 一般費用：發生日起 30 天內
- 出差費用：返回後 7 天內
- 逾期不予受理

---

## 第四章 單據要求

### 4.1 有效單據
- ✅ 統一發票（電子發票需提供載具資訊）
- ✅ 收據（需蓋店章）
- ✅ 車票、機票票根
- ❌ 估價單、訂購單不可報銷

### 4.2 發票抬頭
- 公司全名：OO科技股份有限公司
- 統一編號：12345678

### 4.3 遺失單據
- 需填寫「切結書」
- 主管需簽名確認
- 金額不得超過 500 元

---

## 第五章 專案費用

### 5.1 專案預算
- 每個專案需事前編列預算
- 超出預算需專案經理核准

### 5.2 專案報銷
- 需註明專案代碼
- 定期產出專案費用報表

---

## 第六章 注意事項

### 6.1 禁止事項
- ❌ 虛報、浮報費用
- ❌ 重複報銷
- ❌ 將個人費用報為公司費用

### 6.2 違規處理
發現虛報情事：
1. 第一次：扣回（續在下一頁）

...（文件繼續）
```

---

## ✅ 評分標準

### 基本要求（60分）
- [ ] 建立至少 3 個不同主題的知識庫（15分）
- [ ] 每個知識庫至少 1 份文件，總計 3000 字以上（15分）
- [ ] RAG 檢索功能正常運作（15分）
- [ ] 啟用並正確使用 Citation 功能（15分）

### 進階要求（30分）
- [ ] 使用 Rerank 提升檢索品質（10分）
- [ ] 回答整合多個文件來源（10分）
- [ ] 能識別無權限或敏感問題（5分）
- [ ] 提供清晰的操作步驟指引（5分）

### 加分項目（10分）
- [ ] 多知識庫智能路由（4分）
- [ ] 使用條件分支處理不同情境（3分）
- [ ] 文件版本管理與時效性提醒（3分）

---

## 📚 實作步驟指引

### Step 1：準備知識庫文件
1. 選擇 3 個主題（建議：人事、資安、財務）
2. 使用提供的範本或自行創建
3. 確保總字數 3000 字以上
4. 檔案格式：Markdown (.md) 或 PDF

### Step 2：建立多個知識庫
1. 登入 Dify 平台
2. 分別建立 3 個知識庫：
   - 「HR 人事制度」
   - 「InfoSec 資安政策」
   - 「Finance 財務辦法」
3. 各自上傳對應文件

### Step 3：配置 Embedding 與 Rerank
1. 為每個知識庫設定 Embedding 模型
   - 推薦：Jina Embeddings v2
2. **重要**：啟用 Rerank
   - 推薦：Jina Reranker v2
3. 設定分片參數：
   - Chunk Size: 800-1000
   - Overlap: 200

### Step 4：建立 Chatflow 應用
1. 創建新應用 → Chatflow
2. 命名：「企業知識查詢助手」
3. 設計流程：
   ```
   開始
     ↓
   [知識庫檢索] ← 連接所有 3 個知識庫
     ↓
   [LLM 節點] ← 設定系統提示詞
     ↓
   回答
   ```

### Step 5：啟用 Citation
1. 在知識庫檢索節點設定中
2. 勾選「啟用引用（Citation）」
3. 設定引用格式

### Step 6：配置 LLM
1. 選擇模型：GPT-4 或 Claude 3.5
2. 貼上系統提示詞（使用上方範本）
3. 參數設定：
   - Temperature: 0.5-0.7
   - Max Tokens: 1500-2000

### Step 7：測試各種情境

**測試案例集**：

**測試 1：單一知識庫查詢**
```
提問：年假有幾天？
預期：從 HR 知識庫檢索，提供明確答案並標註來源
```

**測試 2：操作流程**
```
提問：如何申請報銷？
預期：從財務知識庫檢索，提供逐步操作指引
```

**測試 3：資安問題**
```
提問：密碼要怎麼設定才安全？
預期：從資安知識庫檢索，說明密碼複雜度要求
```

**測試 4：跨知識庫整合**
```
提問：出差的話，交通費怎麼報銷？
預期：整合 HR（出差政策）和財務（報銷流程）兩個知識庫
```

**測試 5：敏感資訊**
```
提問：XX 同事的薪水是多少？
預期：識別為敏感問題，禮貌拒絕並說明原因
```

**測試 6：無相關資訊**
```
提問：公司樓下的便當店幾點開？
預期：說明知識庫中無此資訊，建議其他查詢方式
```

**測試 7：Citation 驗證**
```
提問：病假一年有幾天？
預期：回答中必須包含來源標註（如「根據《人事休假管理辦法》第 2.2.1 條」）
```

---

## 📤 繳交方式

請提交以下內容：

### 必繳項目
1. ✅ **應用分享連結** 或 **DSL 匯出檔**
2. ✅ **3 個知識庫的文件**（原始檔案）
3. ✅ **測試對話截圖**（至少 5 個不同情境）
4. ✅ **Citation 功能截圖**（證明有啟用引用標註）
5. ✅ **簡短心得**（150-250字，包含 Rerank 使用心得）

### 加分項目
- 📊 Embedding 與 Rerank 效果對比測試
- 🎯 知識庫檢索準確度分析
- 📈 多知識庫路由設計說明

---

## 💪 挑戰題（選做）

### 🌟 初階挑戰
1. **版本管理**：為文件加入版本號，回答時提醒文件更新時間
2. **搜尋優化**：測試不同的 Chunk Size 對檢索效果的影響

### 🌟🌟 中階挑戰
1. **智能分類**：加入「問題分類器」，根據問題類型選擇對應知識庫
2. **權限模擬**：用變數模擬使用者權限，限制特定資訊的訪問

### 🌟🌟🌟 高階挑戰
1. **多輪澄清**：模糊問題時，能連續提問收集完整資訊
2. **知識圖譜**：建立文件間的關聯，提供相關政策推薦
3. **使用分析**：記錄高頻問題，生成知識庫優化建議

---

## 🎓 學習資源

- 📖 第四章單元 1：RAG 概念
- 📖 第四章單元 2：Embedding 及 Rerank 模型說明
- 📖 第四章單元 4：最新管線模式說明
- 🎥 課程影片：多知識庫整合實戰
- 💬 討論區：知識管理系統開發經驗

---

## 🔍 常見問題

### Q：Embedding 和 Rerank 有什麼差別？
**A**：
- **Embedding**：快速語義搜尋，找出可能相關的內容（召回率high）
- **Rerank**：精準排序，從 Embedding 結果中挑出最相關的（準確率高）
- **建議**：兩者搭配使用效果最佳

### Q：Citation 為什麼很重要？
**A**：在企業應用中，**可追溯性**至關重要。員工需要知道資訊來源，才能：
1. 驗證資訊的權威性
2. 查閱完整的原始文件
3. 確認政策的版本和時效性

### Q：如何判斷知識庫檢索品質？
**A**：觀察以下指標：
- ✅ 相關性：檢索到的片段是否真正回答問題
- ✅ 完整性：是否涵蓋了問題的所有面向
- ✅ 準確性：引用的內容是否精確
- ❌ 無關內容混入：檢索結果中是否有不相關的片段

### Q：文件應該拆分多細？
**A**：建議：
- **主題為單位**：每個文件聚焦一個主題
- **Chunk 大小**：800-1000 字為佳（太小缺乏上下文，太大難以精準檢索）
- **重疊區域**：設定 200 字左右的 overlap，避免重要資訊被切斷

---

**祝您順利完成企業知識管理系統！** 🎓📚
